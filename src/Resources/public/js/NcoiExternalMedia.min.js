class NcoiExternalMedia{constructor(b){this.$=b}addOnClickEvent(d){let e=this.$,f=this;e(document).on("click",".ncoi---release",function(b){b.preventDefault();//Um richtige Chechbox zu finden
//und um Blockcontainer vielleicht auszublenden und iFrame anzuh√§ngen
let c=e(this).parents(".ncoi---blocked"),g=c.find(".ncoi---sliding"),h=e("[data-block-class=\""+g.data("block-class")+"\"]");if(g.prop("checked")){h.prop("checked",!0).trigger("change");let i=g.data("block-class")+"",j=e("[data-block-class=\"ncoi---"+i+"\"]");j.prop("checked",!0).trigger("change");let a=new NcoiTrack(e);a.track(1,d),f.decode(d);let b=e("."+g.data("block-class"));b.each(function(){f.addIframe(e(this))})}else f.isCustomGmap(c)?f.showCustomGmap(c):(f.addIframe(c),c.trigger("change"))})}onChangeSliding(){let d=this.$;d(document).on("click",".ncoi---sliding.ncoi---blocked",function(){let a=d(this).prop("checked"),b=d(this).data("cookie-ids")+"";0<b.indexOf(",")?(b=b.split(","),b.forEach(function(b){d("#ncoi---table-cookie-"+b).prop("checked",a)})):d("#ncoi---table-cookie-"+b).prop("checked",a)})}decode(b){let h=this,i=h.$,a=new NcoiApp(i),c=a.getLocalStorage(b),d=c.cookieIds;i(".ncoi---blocked").each(function(b,e){let f=i(this);d.forEach(function(b){i(e).hasClass("ncoi---cookie-id-"+b)&&0<f.length&&(h.isCustomGmap(f)?h.showCustomGmap(f):(h.addIframe(f),f.trigger("change")))})})}showCustomGmap(){let b=this.$;b(".ce_google_map").removeClass("ncoi---hidden"),b(".mod_catalogUniversalView").removeClass("ncoi---hidden"),b(".ncoi---custom_gmap").addClass("ncoi---hidden")}isCustomGmap(b){let c=b.parent(".ncoi---custom_gmap");return 0<c.length}addIframe(d){let e=this.$;if(!d.hasClass("ncoi---hidden")){let b="";if(1<d.length)for(let a=0;a<d.length;a++)e("."+d[a].classList[3]).each(function(){b=e(this).find("script").text().trim()});else b=d.find("script").text().trim();d.addClass("ncoi---hidden"),0<=b.indexOf("data-only-script")?e("head").append(b):d.after(b)}}}
